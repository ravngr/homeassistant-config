---

pkg_cover:
  cover:
    - platform: template
      covers:
        study_curtain:
          <<: &curtain_common
            device_class: curtain
            optimistic: true
          friendly_name: "Study Curtains"
          unique_id: "66fe59c2-e95c-4612-884e-7336104858df"
          value_template: "{{ state_attr('cover.study_curtains_motor', 'current_position') | float(0) > 5 }}"
          position_template: "{{ state_attr('cover.study_curtains_motor', 'current_position') | float(0) }}"
          availability_template: "{{ is_state('cover.study_curtains_motor', ['open', 'closed']) }}"
          open_cover:
            service: cover.open_cover
            data:
              entity_id: cover.study_curtains_motor
          close_cover:
            service: cover.close_cover
            data:
              entity_id: cover.study_curtains_motor
          stop_cover:
            service: cover.stop_cover
            data:
              entity_id: cover.study_curtains_motor
          set_cover_position:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.study_curtains_motor
              position: "{{ position }}"

    - platform: template
      covers:
        master_curtain:
          <<: *curtain_common
          friendly_name: "Master Bedroom Curtains"
          unique_id: "f7131551-49c7-4ce1-807a-433f369cda7a"
          value_template: "{{ state_attr('cover.master_bedroom_curtains_motor', 'current_position') | float(0) > 5 }}"
          position_template: "{{ state_attr('cover.master_bedroom_curtains_motor', 'current_position') | float(0) }}"
          availability_template: "{{ is_state('cover.master_bedroom_curtains_motor', ['open', 'closed']) }}"
          open_cover:
            service: cover.open_cover
            data:
              entity_id: cover.master_bedroom_curtains_motor
          close_cover:
            service: cover.close_cover
            data:
              entity_id: cover.master_bedroom_curtains_motor
          stop_cover:
            service: cover.stop_cover
            data:
              entity_id: cover.master_bedroom_curtains_motor
          set_cover_position:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.master_bedroom_curtains_motor
              position: "{{ position }}"

    - platform: template
      covers:
        kids_bedroom_curtain:
          <<: *curtain_common
          friendly_name: "Kid's Bedroom Curtains"
          unique_id: "9f404f1f-547f-45d2-931f-878ab4f0e46b"
          value_template: "{{ state_attr('cover.kids_bedroom_curtains_motor', 'current_position') | float(0) > 5 }}"
          position_template: "{{ state_attr('cover.kids_bedroom_curtains_motor', 'current_position') | float(0) }}"
          availability_template: "{{ is_state('cover.kids_bedroom_curtains_motor', ['open', 'closed']) }}"
          open_cover:
            service: cover.open_cover
            data:
              entity_id: cover.kids_bedroom_curtains_motor
          close_cover:
            service: cover.close_cover
            data:
              entity_id: cover.kids_bedroom_curtains_motor
          stop_cover:
            service: cover.stop_cover
            data:
              entity_id: cover.kids_bedroom_curtains_motor
          set_cover_position:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.kids_bedroom_curtains_motor
              position: "{{ position }}"

    - platform: template
      covers:
        lounge_blind:
          device_class: blind
          optimistic: true
          friendly_name: "Lounge Blinds"
          unique_id: "ebb8fb57-9b16-43cc-b2a5-9ab7c3dfbdd4"
          value_template: >-
            {{
              (
                (
                  states('input_number.lounge_blinds_close_position') | int(0)
                ) -
                state_attr('cover.lounge_blinds_motor', 'current_position') |
              int(50)) |
              abs > 5
            }}
          position_template: "{{ state_attr('cover.lounge_blinds_motor', 'current_position') | int(0) }}"
          availability_template: "{{ is_state('cover.lounge_blinds_motor', ['open', 'closed']) }}"
          open_cover:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.lounge_blinds_motor
              position: "{{ states('input_number.lounge_blinds_open_position') | int(100) }}"
          close_cover:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.lounge_blinds_motor
              position: "{{ states('input_number.lounge_blinds_close_position') | int(0) }}"
          stop_cover:
            service: cover.stop_cover
            data:
              entity_id: cover.lounge_blinds_motor
          set_cover_position:
            service: cover.set_cover_position
            data_template:
              entity_id: cover.lounge_blinds_motor
              position: "{{ position }}"

  input_number:
    lounge_blinds_close_position:
      name: "Lounge Blinds Close Position"
      icon: "mdi:blinds"
      <<: &input-range
        min: 0
        max: 100
        step: 5

    lounge_blinds_open_position:
      name: "Lounge Blinds Open Position"
      icon: "mdi:blinds-open"
      <<: *input-range
